% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/roll_perf_stats.R
\name{roll_perf_stats}
\alias{roll_perf_stats}
\title{Rolling performance & factor statistics for a strategy vs. benchmark}
\usage{
roll_perf_stats(
  df_merged,
  start_date,
  end_date,
  conf_level = 0.95,
  frequency = c("daily", "weekly", "monthly"),
  mar = 0,
  n_boot = 1000
)
}
\arguments{
\item{df_merged}{\code{data.frame} with columns \code{date} (Date) and exactly one
numeric strategy returns column (period simple returns). Any additional columns
besides \code{date} will trigger an error.}

\item{start_date, end_date}{Date bounds (inclusive) for the sample.}

\item{conf_level}{Confidence level for VaR/ES and summary CIs (default \code{0.95}).}

\item{frequency}{One of \code{"daily"}, \code{"weekly"}, \code{"monthly"}.
Controls resampling, rolling window length, and annualization factor.}

\item{mar}{Minimum acceptable return for Sortino ratio (default \code{0}).}

\item{n_boot}{Number of bootstrap draws for VaR/ES (default \code{1000}).}
}
\value{
A \code{list} with two elements:
\describe{
  \item{\code{rolling}}{A data.frame of rolling statistics, one row per window end date.}
  \item{\code{summary}}{A data.frame summarizing the rolling metrics across windows
        (mean, SD, t-stat, two-sided p-value, and t-based confidence interval).}
}
}
\description{
Computes **sliding-window** (rolling) performance and factor statistics for a
single strategy series tested against a benchmark, using Fama–French 3 factors
and the risk-free rate. The function aligns all inputs to the selected
\code{frequency}, merges them on \code{date}, cleans missing data via
\code{ZZ_remove_na()}, and then applies rolling regressions and performance metrics.
}
\details{
\itemize{
  \item \strong{Input strategy:} \code{df_merged} must contain a \code{date} column
        and exactly one additional (numeric) column with the strategy \emph{period} returns
        (simple returns), at daily granularity. The function will resample to weekly/monthly
        if requested.
  \item \strong{Benchmark:} Retrieved via \code{ZZ_benchmark()} at the same frequency.
  \item \strong{Fama–French:} Downloaded via \code{download_french_data("Fama/French 3 Factors [Daily]")},
        converted to proportions (divided by 100), and resampled to match \code{frequency}.
  \item \strong{Cleaning:} After merging, the data are cleaned with \code{ZZ_remove_na(..., protect = "date")}.
  \item \strong{Rolling window:} Window length and annualization use
        \code{252} (daily), \code{52} (weekly), \code{12} (monthly).
        Windows slide by one period (i.e., \code{by = 1} in \code{zoo::rollapply}).
  \item \strong{Metrics:} CAPM and FF3 alphas/betas (alphas annualized),
        annualized excess return/volatility, Sharpe, CAGR, tracking error,
        information ratio, Sortino, high-water mark, max drawdown, bootstrap VaR
        and ES (daily, with simple annualized approximations).
}
}
\section{Assumptions}{

\itemize{
  \item Strategy returns in \code{df_merged} are \emph{period simple returns}.
  \item Risk-free and FF3 factors are in the same periodicity after resampling.
  \item VaR/ES annualization uses simple square-root/time scaling approximations.
}
}

\examples{
\dontrun{
# df_strat must have columns: date, Strategy
out <- roll_perf_stats(
  df_merged  = df_strat,
  start_date = as.Date("2015-01-01"),
  end_date   = Sys.Date(),
  frequency  = "monthly",
  conf_level = 0.95,
  n_boot     = 1000
)

head(out$rolling)
out$summary
}

}
\seealso{
\code{\link{ZZ_benchmark}}, \code{\link{ZZ_remove_na}}
}
